<!doctype html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AD-Guard AI (Demo)</title>

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- React 18 UMD -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

  <!-- Babel (for JSX in a single file) -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>

<body class="bg-slate-50 text-slate-900">
  <div id="root"></div>

  <script type="text/babel">
    const { useMemo, useState } = React;

    const SOURCE_LINE = "출처: AD-Guard AI (https://no11519-hue.github.io/ad-guard-ai/)";

    // ---- 규칙 기반(키 없이) 점검 엔진 ----
    const RULES = [
      {
        name: "확정/보장",
        regex: /(100%|무조건|보장|확실|완벽|전부|절대)/g,
        reason: "확정·보장 표현은 과장/오해로 해석될 수 있어요.",
        replace: "개인차가 있을 수 있으며 도움을 줄 수 있습니다."
      },
      {
        name: "단기간 과장",
        regex: /(하루|1일|2일|3일|단\s*\d+일|즉시|바로|순식간)/g,
        reason: "너무 빠른 결과를 단정하면 과장으로 보일 수 있어요.",
        replace: "사용 환경에 따라 체감 시점은 달라질 수 있습니다."
      },
      {
        name: "부작용 0",
        regex: /(부작용\s*0%|부작용\s*없음|안전\s*보장)/g,
        reason: "부작용 ‘없음/0%’ 단정은 위험해요.",
        replace: "사용자에 따라 반응이 다를 수 있습니다."
      },
      {
        name: "의학/치료 단정",
        regex: /(완치|치료|통증\s*해결|병\s*낫|약\s*대신)/g,
        reason: "의학적 효능을 확정적으로 말하면 민감해요.",
        replace: "일상 케어에 도움을 줄 수 있습니다(개인차)."
      },
      {
        name: "권위 과장",
        regex: /(의사\s*인정|전문의\s*추천|임상\s*검증|논문\s*입증|기적)/g,
        reason: "근거가 불명확하면 과장으로 오해될 수 있어요.",
        replace: "사용 후기/체감 사례를 바탕으로 안내드립니다(개인차)."
      },
    ];

    function pickRisks(text) {
      const hits = [];
      for (const r of RULES) {
        const m = text.match(r.regex);
        if (m && m.length) {
          hits.push({
            phrase: m[0],
            reason: r.reason,
            replace: textReplaceOne(text, r.regex, r.replace),
          });
        }
      }
      // 부족하면 일반 케이스로 채우기
      while (hits.length < 3) {
        hits.push({
          phrase: "과장/단정 표현 가능",
          reason: "표현이 강하면 신고/반려 리스크가 커질 수 있어요.",
          replace: "개인차가 있을 수 있으며 도움을 줄 수 있습니다."
        });
      }
      return hits.slice(0, 3);
    }

    function textReplaceOne(text, regex, replacement) {
      return text.replace(regex, replacement);
    }

    function riskLevel(text) {
      let count = 0;
      for (const r of RULES) {
        const m = text.match(r.regex);
        if (m && m.length) count += 1;
      }
      if (count >= 3) return "위험";
      if (count >= 1) return "주의";
      return "안전";
    }

    function makeLabel() {
      return {
        short: "AI광고 포함",
        long: "본 광고의 일부 문구/이미지는 AI를 활용해 제작되었습니다."
      };
    }

    function platformCopy(baseText) {
      // 너무 길면 잘라서 느낌만 살리기
      const short = baseText.replace(/\s+/g, " ").slice(0, 60);
      return {
        insta: `${short}… (개인차 있음)`,
        blog: `아래 내용은 제품/서비스 안내이며, 개인차가 있을 수 있습니다.\n핵심 포인트: ${short}`,
        kakao: `간단 안내드려요 🙂\n${short}\n(개인차가 있을 수 있어요!)`
      };
    }

    function buildOutput(input) {
      const lvl = riskLevel(input);
      const label = makeLabel();
      const risks = pickRisks(input);

      // 플랫폼 문구는 “완화된 문장” 기반으로 생성
      let softened = input;
      for (const r of RULES) softened = softened.replace(r.regex, r.replace);
      const pf = platformCopy(softened);

     const checklist = [
  "‘100%/무조건/보장’ 같은 단정 표현 제거했나요?",
  "단기간 결과(하루/3일/즉시)를 확정하지 않았나요?",
  "의학/치료/완치처럼 민감한 효능 단정이 없나요?",
  "개인차/사용환경 차이를 자연스럽게 넣었나요?",
  "플랫폼에 맞게 길이/톤을 맞췄나요?"
];
